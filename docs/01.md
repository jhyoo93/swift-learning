# Swift: 옵셔널, 클래스, 구조체(Struct), 프로퍼티 옵저버

---  

## 1) 옵셔널(Optional). 

### 1.1 정의와 배경
- 옵셔널은 "값이 있을 수도 있고 없을 수도" 있음을 타입 시스템에 명시하는 기능이다.  
- 타입 표기: `T?`는 `Optional<T>`의 축약형. 예) `Int?`는 `Optional<Int>`.   
- `nil`은 값 부재를 의미하며 옵셔널 타입에만 할당 가능.

```swift
var age: Int? = nil
age = 29
```

---

### 1.2 핵심 언래핑 방법

| 방법 | 설명 | 예시 |
|---|---|---|
| **강제 언래핑** | (!)  위험, 꼭 값이 있다고 확신될 때만 |
| **옵셔널 바인딩** | (if let / guard let) 가장 안전, 권장 |
| **옵셔널 체이닝** | (?.) 중첩 접근 시 편리 |
| **Nil 병합** | (??) nil일 경우 기본값 제공 |

---

## 2) 클래스(Class) vs 구조체(Struct)

### 2.1 공통점
- 프로퍼티, 메서드 이니셜라이저, 확장(Extension), 프로토콜 채택 가능.

---

### 2.2 차이 핵심 요약

| 구분 | Struct | Class |
|---|---|---|
| 타입 의미 | 값 타입(Value) | 참조 타입(Reference) |
| 대입/전달 | 복사됨 → 원본과 독립 | 참조 공유됨 → 한쪽 수정 시 다른 쪽도 영향 |
| 상속 | 불가능 | 가능 |
| 메모리 관리 | ARC 불필요(스택/값 복사) | ARC 필요(힙, 참조 카운트) |
| 식별성 | 없음 | 있음(`===`) |
| 동시성 안정성 | 유리 (복사 기반) | 불리 (참조 공유) |

---

```swift

// Struct
struct Point {
    var x: Int
    var y: Int
}

var p1 = Point(x: 0, y: 0)
var p2 = p1 // 값 복사
p2.x = 10
print(p1.x, p2.x) // 0, 10 (서로 독립)

```

```swift

// Class
class Counter {
    var value = 0
    func increment() { value += 1 }
}

let c1 = Counter()
let c2 = c1 // 같은 인스턴스 참조
c2.increment()
print(c1.value) // 1 (같이 변함)

```

---

## 3) 프로퍼티 옵저버(Property Observer)

### 3.1 정의
- 프로퍼티 옵저버는 프로퍼티 값이 변경될 때 자동으로 호출되는 블록.
- 저장 프로퍼티(Stored Property)와 계산 프로퍼티(Computed Property) 모두에 적용 가능.
- 상속 시 오버라이드 가능

---

### 3.2 종류
- willSet
    - 값이 변경되기 직전에 호출.
    - 새로 들어올 값을 newValue로 자동 전달.
    - 커스텀 이름 지정 가능.
- didSet
    - 값이 변경된 직후에 호출
    - 변경 전 값을 oldValue로 자동 전달.
    - 커스텀 이름 지정 가능.

---

### 3.3 예시

```swift

struct StepCounter {
    var totalSteps: Int = 0 {
        willSet(newSteps) {
            print("총 걸음 수가 \(newSteps)로 변경될 예정")
        }
        didSet(oldSteps) {
            if totalSteps > oldSteps {
                print("총 \(totalSteps - oldSteps) 걸음 추가")
            }
        }
    }
}

var counter = StepCounter()
counter.totalSteps = 100
// 출력: 총 걸음 수가 100로 변경될 예정
// 출력: 총 100 걸음 추가

counter.totalSteps = 250
// 출력: 총 걸음 수가 250로 변경될 예정
// 출력: 총 150 걸음 추가

```

---

## 4) 요약

- **옵셔널**: 값이 없을 수 있음을 타입으로 표현, 안전한 언래핑이 기본.
- **Struct**: 값, 복사 기반, 스레드 안정성 유리, 상속 불가.
- **Class**: 참조, 식별성·상속·공유 상태 지원, ARC 관리와 순환 참조 주의.
- **프로퍼티 옵저버**: 프로퍼티 값 변경 시점에 추가 로직 실행 (willSet / didSet).

